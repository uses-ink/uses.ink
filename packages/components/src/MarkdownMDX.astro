---
import { runMDX } from "@uses.ink/client";
import type { MDXCompileResult } from "@uses.ink/types";
import { mdxComponents } from "./mdx";
const { meta, runnable, readingTime }: MDXCompileResult = Astro.props.result;
const Content = await runMDX(runnable);
---

<div>
    <p>Reading time: {readingTime?.text}</p>
    <Content components={mdxComponents} />
</div>

<script src="./lib/pre-utils.ts" />
<script is:inline define:vars={{ meta }}>
    const PROSE_THEMES = {
        default: "prose-neutral",
        gruvbox: "prose-gruvbox",
        solarized: "prose-solarized",
        nord: "prose-nord",
        monokai: "prose-monokai",
    };
    const theme = meta.theme || "default";
    document.documentElement.dataset.theme = theme;
    const rootArticle = document.getElementById("root-article");
    rootArticle.classList.remove(...Object.values(PROSE_THEMES));
    rootArticle.classList.add(PROSE_THEMES[theme] || PROSE_THEMES.default);

    const FONTS = {
        sans: "font-sans",
        serif: "font-serif",
        mono: "font-mono",
    };

    const font = meta.font || "sans";
    rootArticle.classList.remove(...Object.values(FONTS));
    rootArticle.classList.add(FONTS[font] || FONTS.sans);
</script>